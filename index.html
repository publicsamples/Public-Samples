<html>
<head>
 

	<script src="https://unpkg.com/@webcomponents/webcomponentsjs@^2/webcomponents-bundle.js"></script>
	<script src="libraries/Tone/Tone.js"></script>
    <script type="text/javascript" src="libraries/Tone/NexusUI.js"></script>

	
<body>

<div id="gain"><div>
<tone-content>
		<tone-transport></tone-transport>
		<tone-step-sequencer></tone-step-sequencer>
			<tone-piano polyphonic></tone-piano>
			<tone-reverb collapsed><tone-reverb>
			<tone-ping-pong-delay collapsed></tone-ping-pong-delay>
		</tone-content>
	</tone-example>
<script type="text/javascript">

// Create interfaces

var gain = new Nexus.Slider("#gain");


// Create a sound source
var volume = new Tone.Volume(-Infinity).toMaster();
var eq = new Tone.EQ3({

				}).connect(volume);
				
		var reverb = new Tone.Reverb({
			"wet" : 0.0
				}).connect(eq);
				
				//the feedback delay
				var feedbackDelay = new Tone.PingPongDelay({
					"delayTime" : "8n",
					"feedback" : 0.6,
					"wet" : 0.0
				}).connect(reverb);
	
	var piano = new Tone.Sampler({
		
			"C1" : "FILE1.[mp3|ogg]",
			"C#1" : "FILE2.[mp3|ogg]",
			"D1" : "FILE3.[mp3|ogg]",
			"D#1" : "FILE4.[mp3|ogg]",
			"E1" : "FILE5.[mp3|ogg]",
			"F1" : "FILE6.[mp3|ogg]",
			"F#1" : "FILE7.[mp3|ogg]",
			"G1" : "FILE8.[mp3|ogg]",
			"G#1" : "FILE9.[mp3|ogg]",
			"A2" : "FILE10.[mp3|ogg]",
			"A#2" : "FILE11.[mp3|ogg]",
			"B2" : "FILE12.[mp3|ogg]",
			"C2" : "FILE13.[mp3|ogg]",
			"C#2" : "FILE14.[mp3|ogg]",
			"D2" : "FILE15.[mp3|ogg]",
			"D#2" : "FILE16.[mp3|ogg]",
			"E2" : "FILE17.[mp3|ogg]",
			"F2" : "FILE18.[mp3|ogg]",
			"F#2" : "FILE19.[mp3|ogg]",
			"G2" : "FILE20.[mp3|ogg]",
			"G#2" : "FILE21.[mp3|ogg]",
			"A2" : "FILE22.[mp3|ogg]",
			
		}, {
			"release" : 45,
			"baseUrl" : "AkaiAX80/Solids/"
        }).connect(feedbackDelay);
		
		var keys = new Tone.Players({
			"A" : "AkaiAX80/Solids/FILE1.[mp3|ogg]",
			"C#" : "AkaiAX80/Solids/FILE4.[mp3|ogg]",
			"E" : "AkaiAX80/Solids/FILE8.[mp3|ogg]",
			"F#" : "AkaiAX80/Solids/FILE13.[mp3|ogg]",
		}, {
			"volume" : 00,
			"fadeOut" : "8512n",
			}).connect(feedbackDelay);
			
			//the notes
			var noteNames = ["F#", "E", "C#", "A"];
			var loop = new Tone.Sequence(function(time, col){
				var column = document.querySelector("tone-step-sequencer").currentColumn;
				column.forEach(function(val, i){
					if (val){
						//slightly randomized velocities
						var vel = Math.random() * 0.5 + 0.5;
						keys.get(noteNames[i]).start(time, 0, "8n", 560, vel);
					}
				});
				//set the columne on the correct draw frame
				Tone.Draw.schedule(function(){
					document.querySelector("tone-step-sequencer").setAttribute("highlight", col);
				}, time);
			}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);
			
		

// Listen for interface events
	
	
	document.querySelector("tone-piano").bind(piano);
		document.querySelector("tone-reverb").bind(reverb);
		document.querySelector("tone-transport").bind(Tone.Transport);
document.querySelector("tone-ping-pong-delay").bind(feedbackDelay);

gain.on('change',function(v) {
	volume.volume.rampTo(v,.1)
});
	
gain.min = -100;
gain.max = 0;
gain.value = -30;


		Tone.Transport.on("stop", () => {
			setTimeout(() => {
				document.querySelector("tone-step-sequencer").setAttribute("highlight", "-1");
			}, 100);
		});
	
</script>
	</body>
</head>

</html>
