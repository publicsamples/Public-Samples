<meta charset="utf-8">
<title>Your page title here :)</title>
<meta name="description" content="">
<meta name="author" content="">

<!-- Mobile Specific Metas
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- FONT
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

<!-- CSS
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<link rel="stylesheet" href="https://modularsamples.com/css/normalize.css">
<link rel="stylesheet" href="https://modularsamples.com/css/skeleton.css">
<link rel="stylesheet" href="https://modularsamples.com/css/style.css">

<!-- Ext. Script
–––––––––––––––––––––––––––––––––––––––––––––––––– -->
<script src="https://unpkg.com/tone"></script>
<script src="https://unpkg.com/@tonejs/ui"></script>

<script type="text/javascript" src="https://modularsamples.com/external-js/NexusUI.js"></script>
<script type="text/javascript" src="https://modularsamples.com/external-js/audiokeys.js"></script>



<body onload="loadJS('patches/file1.js');">

<tone-loader></tone-loader>



<!-- html
–––––––––––––––––––––––––––––––––––––––––––––––––– --> 

<div class="row">

<div class="one-half column">
<div class="dropdown">
<button>Patches</button>
<div class="dropdown-content">
<ol>
<li onclick="stop(); loadJS('patches/file1.js');">Yamaha CS30 hits</li>
<li onclick="stop(); loadJS('patches/file2.js');">Jupiter 4 Kit</li>
<li onclick="stop(); loadJS('patches/file3.js');">Mono/Poly Hits</li>
<li onclick="stop(); loadJS('patches/file4.js');">Roland SH2 Hits</li>
<li onclick="stop(); loadJS('patches/file5.js');">Xpander kit</li>



</ol>
</div>
</div>
<tone-step-sequencer id="seq1"></tone-step-sequencer>
<tone-step-sequencer id="seq2"></tone-step-sequencer>
<tone-step-sequencer id="seq3"></tone-step-sequencer>
<tone-step-sequencer id="seq4"></tone-step-sequencer>
<tone-step-sequencer id="seq5"></tone-step-sequencer>

<br>
 <div id="power"></div>

<table>
 <tr>

   <td>Tempo</td> 
<td>Volume</td> 
 </tr>
 <tr>
   <td id="tempo"></td>
<td id="vol"></td>
 </tr>
</table>

</div>


<div class="one-half column">
<p>&nbsp;</p>
<table>

    <tr>
      <th>Filter</th>
    </tr>
  <tr>
    <td>Wet</td>
    <td>CutOff</td>
    <td>Res</td> 
	 </tr>
  <tr>
	<td id="fwet"></td>
	<td id="baseFrequency"></td>
	<td id="Q"></td>
	</tr>
	<tr> 
		  <td>LFO Depth</td> 
		   <td>LFO Speed</td> 
	  </tr>
	 <tr>
	<td id="depth"></td>
	<td id="ffrequency"></td>
	

</tr>


    <tr>
      <th>Delay</th>
    </tr>
  <tr>
    <td>Wet</td>
    <td>Delay Time</td> 
    <td>Feedback</td>
  </tr>
  <tr>
	<td id="dwet"></td>
	<td id="dtime"></td>
	<td id="dfeedback"></td>
</tr>
    <tr>
      <th>Reverb</th>
    </tr>
  <tr>
	  
    <td>Wet</td>
    <td>Size</td> 
    <td>Dampening</td>
 
  </tr>
  <tr>
	<td id="rwet"></td>
	<td id="roomSize"></td>
	<td id="dampening"></td>
</table>

</div>
 <div class="row">
    <div class="eleven column">
	<p style>built with <a href="https://tonejs.github.io">Tone.js</a>, <a href="https://nexus-js.github.io/ui/">Nexus UI</a> &amp; <a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwimgb_vssLlAhXTiVwKHY-gDh4QFjAAegQIAxAB&amp;url=https%3A%2F%2Fgithub.com%2Fkylestetz%2FAudioKeys&amp;usg=AOvVaw3I_1NqASkspAJmD59WQUWV">Audiokeys.js</a></p>
	
	</div>

  </div>

<script type="text/javascript">

function loadJS(file) {
// DOM: Create the script element
var jsElm = document.createElement("script");
// set the type attribute
jsElm.type = "application/javascript";
// make the script element load file
jsElm.src = file;
// finally insert the element to the body element in order to load the script
document.body.appendChild(jsElm);
}

var eq = new Tone.Gain().toMaster({
})

var verb = new Tone.Freeverb({
"wet" : 0.0
}).connect(eq);	

//the feedback delay
var feedbackDelay = new Tone.PingPongDelay({
"wet" : 0.0
}).connect(verb);		


var filter = new Tone.AutoFilter({
	"wet" : 0.0
}).connect(feedbackDelay).start();		

//the notes
var noteNames = ["1", "2", "3", "4"];
var noteNames2 = ["5", "6", "7", "8"];	
var noteNames3 = ["9", "10", "11", "12"];
var noteNames4 = ["13", "14", "15", "16"];
var noteNames5 = ["17", "18", "19", "20"];			
		

var loop = new Tone.Sequence(function(time, col){
	var column = document.querySelector("tone-step-sequencer").currentColumn;
	column.forEach(function(val, i){
		if (val){
			//slightly randomized velocities
			var vel = Math.random() * 0.5 + 0.5;
			keys.get(noteNames[i]).start(time, 0, "32n", 0, vel);
		}
	});
	//set the columne on the correct draw frame
	Tone.Draw.schedule(function(){
		document.querySelector("tone-step-sequencer").setAttribute("highlight", col);
	}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);



var loop = new Tone.Sequence(function(time, col){
var column = document.querySelector("#seq1").currentColumn;
column.forEach(function(val, i){
if (val){

//slightly randomized velocities
keys.get(noteNames[i]).start(time, 0, "32n", 0,);
}
});
//set the columne on the correct draw frame
Tone.Draw.schedule(function(){
document.querySelector("#seq1").setAttribute("highlight", col);
}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);

var loop2 = new Tone.Sequence(function(time, col){
var column2 = document.querySelector("#seq2").currentColumn;
column2.forEach(function(val, i){
if (val){

//slightly randomized velocities
keys.get(noteNames2[i]).start(time, 0, "32n", 0,);
}
});

//set the columne on the correct draw frame
Tone.Draw.schedule(function(){
document.querySelector("#seq2").setAttribute("highlight", col);
}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);


var loop3 = new Tone.Sequence(function(time, col){
var column3 = document.querySelector("#seq3").currentColumn;
column3.forEach(function(val, i){
if (val){
keys.get(noteNames3[i]).start(time, 0, "32n", 0,);
}
});
//set the columne on the correct draw frame
Tone.Draw.schedule(function(){
document.querySelector("#seq3").setAttribute("highlight", col);
}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);

var loop4 = new Tone.Sequence(function(time, col){
var column4 = document.querySelector("#seq4").currentColumn;
column4.forEach(function(val, i){
if (val){

//slightly randomized velocities
keys.get(noteNames4[i]).start(time, 0, "32n", 0,);
}
});
//set the columne on the correct draw frame
Tone.Draw.schedule(function(){
document.querySelector("#seq4").setAttribute("highlight", col);
}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);

var loop5 = new Tone.Sequence(function(time, col){
var column5 = document.querySelector("#seq5").currentColumn;
column5.forEach(function(val, i){
if (val){

//slightly randomized velocities
keys.get(noteNames5[i]).start(time, 0, "32n", 0,);
}
});

//set the columne on the correct draw frame
Tone.Draw.schedule(function(){
document.querySelector("#seq5").setAttribute("highlight", col);
}, time);
}, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);

function stop() {
Tone.Transport.stop();
keys.disconnect();


}
//chorus Controls

var fwet = new Nexus.Slider('#fwet', {
'mode': 'relative', // "absolute" or "absolute"
'size': [20, 50],
"min": 0,
"max" : 1,
'value' : 0
})

fwet.on('change', function(v) {
filter.wet.value = v;
});

var baseFrequency = new Nexus.Slider('#baseFrequency', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 20,
'max': 4000,
'step': 0,
	'value': 200
})

baseFrequency.on('change', function(v) {
filter.filter.frequency.value = v;
});

var Q = new Nexus.Slider('#Q', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0,
'max': 10,
'step': 0,
	'value': 1
})

Q.on('change', function(v) {
filter.filter.Q.value = v;
});

var depth = new Nexus.Slider('#depth', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0.00,
'max': 1.00,
'step': 0,
'value': 0
})

depth.on('change', function(v) {
filter.depth.value = v;
});

var ffrequency = new Nexus.Slider('#ffrequency', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0,
'max': 20,
'step': 0,
	'value': 4
})

ffrequency.on('change', function(v) {
filter.frequency.value = v;
});

//delay Controls

var dwet = new Nexus.Slider('#dwet', {
'mode': 'relative', // "absolute" or "absolute"
'size': [20, 50],
'min': 0.0,
'max': 1.0,
'step': 0,
'value': 0
})

dwet.on('change', function(v) {
feedbackDelay.wet.value = v;
});

var dtime = new Nexus.Slider('#dtime', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0.01,
'max': 1.0,
'step': 0,
'value': 0.25
})

dtime.on('change', function(v) {
feedbackDelay.delayTime.value = v;
});

var dfeedback = new Nexus.Slider('#dfeedback', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0.0,
'max': 0.95,
'step': 0,
'value': 0.60
})

dfeedback.on('change', function(v) {
feedbackDelay.feedback.value = v;
});

//Reverb Controls

var rwet = new Nexus.Slider('#rwet', {
'mode': 'relative', // "absolute" or "absolute"
'size': [20, 50],
'min': 0,
'max': 1,
'step': 0,
'value': 0
})

rwet.on('change', function(v) {
verb.wet.value = v;
});

var roomSize = new Nexus.Slider('#roomSize', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 0.10,
'max': 0.95,
'step': 0,
'value': 0.70
})

roomSize.on('change', function(v) {
verb.roomSize.value = v;
});

var dampening = new Nexus.Slider('#dampening', {
'mode': 'absolute', // "absolute" or "absolute"
'size': [20, 50],
'min': 100,
'max': 5000,
'step': 0,
'value': 3000
})

dampening.on('change', function(v) {
verb.dampening.value = v;
});

//Transport/seq Controls

var power = new Nexus.TextButton("power", { mode: "toggle", size: [40, 40], text: "▶", alternate: "▪"});		
power.on('change', v => v ? Tone.Transport.start() : Tone.Transport.stop())

var tempo = new Nexus.Dial('#tempo', {size: [35, 35], min: 50,max: 200,  value: 120 });
tempo.on('change', v => Tone.Transport.bpm.value = v)

var vol = new Nexus.Dial('#vol', {size: [35, 35], min: 0,max: 1,  value: 0.5 });
vol.on('change', v => eq.gain.value = v)

Tone.Transport.on("stop", () => {
setTimeout(() => {
document.querySelector("#seq1").setAttribute("highlight", "-1");
document.querySelector("#seq2").setAttribute("highlight", "-1");
document.querySelector("#seq3").setAttribute("highlight", "-1");
}, 100);

});

//keys


</script>

</body>
</html>